<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Semtag by EivindEE</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/EivindEE/SemTag">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/EivindEE/SemTag/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/EivindEE/SemTag/tarball/master">TAR</a></li>
          <li class="title">DOWNLOAD</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Semtag</h1>
          <p>SemTag is a tool which lets you tag your content with an unrestricted semantic vocabulary. (It's part of my master thesis in information science).</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/EivindEE">EivindEE</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="http://twitter.com/#!/michigangraham">mattgraham</a></span>
        </div>

        <h1>SemTag</h1>

<h1>Tests</h1>

<p>To run the tests for this project, open <code>/spec/SpecRunner.html</code>.
The tests will then be run in your browser. 
This package will be tested on Safari, Chrome and FireFox as these are the ones I have access to.
Support for IE might be added at a later time.</p>

<h1>Purpose of SemTagExtractor</h1>

<p>SemTagExtractor should take a pice of text, let the user mark the parts that have an important semantic meaning,
and extract these parts for further processing.</p>

<p>Special care needs to be taken with the ranges of the selection. 
Since we need to insert the meta data into tags we can't just use the user range without some checks.
Consider the case:</p>

<p><code>&lt;p&gt;</code>some text <span style="background: lightblue;"> in a p<code>&lt;/p&gt; &lt;p&gt;</code> pluss some </span>  other text <code>&lt;/p&gt;</code></p>

<p>If we simply inserted a tag we would get invalid HTML:</p>

<p><code>&lt;p&gt;</code>some text <code>&lt;tag&gt;</code> in a p<code>&lt;/p&gt; &lt;p&gt;</code> pluss some <code>&lt;/tag&gt;</code>  other text <code>&lt;/p&gt;</code></p>

<p>To get a well formed HTML document we need to either close and open the HTML tags</p>

<p><code>&lt;p&gt;</code>some text <code>&lt;/p&gt;&lt;tag&gt;&lt;p&gt;</code> in a p<code>&lt;/p&gt; &lt;p&gt;</code> pluss some <code>`&lt;/p&gt;&lt;/tag&gt;&lt;p&gt;</code>  other text <code>&lt;/p&gt;</code></p>

<p>which would change the meaning and probably the layout of the document or we could expand the range of the selection:</p>

<p><code>&lt;tag&gt;&lt;p&gt;</code>some text in a p<code>&lt;/p&gt;</code> <code>&lt;p&gt;</code> pluss some   other text <code>&lt;/p&gt;&lt;/tag&gt;</code></p>

<p>extending the range in this way should conserve the meaning of the original markup and still have the selected text in scope.</p>

<h2>Initial specifications for semtag.js:</h2>

<ul>
<li>semtag should be constructed by giving the id of the element containing the text, and the id of the trigger.</li>
<li>When the trigger is pressed the selected text should tagged for extraction</li>
</ul>

<p>The simple case is when both the start and end of the selected text is within the same node
in the DOM. In these cases the item can be tagged simply by appending and prepending tags.
The more difficult case is when the start and end nodes are different. 
In this case the selection has to be expanded in such a way as to maintain the well formed-ness of the DOM.</p>

<p>There are several way one could solve this problem.
One way would be to simply append the tag to the first common ancestor for the two points.
A way which may be better would be to track the nodes up to their common ancestor and see 
if they are the same node. If they are not, then surround the nodes with a tag.</p>

<h2>Proposed functions</h2>

<p>All functions are assumed to be run in the browser, with access to the global document and window objects.</p>

<ul>
<li><p>Find correct scope
<code>
@param range: Range, the Range object containing the selected text
@return Range, a range object containing the range which should be tagged
</code></p></li>
<li><p>Surround DocumentFragment with tags</p>

<p><code>
@param range: Range, the range to be surrounded with tags
@param string: tag, the name of the tag to be created(default: span) 
@param string: className, the name of the class the tag should be given(default: none)
@return a Element object containing the tagged text
</code></p></li>
<li><p>Ancestor or self (to make sure we only tag the content) </p>

<p><code>
@param descendant: Object with ancestor, the object to check if has ancestor (must have a parentNode attribute!)
@param ancestor: HTMLElement, the element to check if is ancestor
@return true iff descendant is a descendant of ancestor
</code></p></li>
<li><p>Extract tags
<code>
@return a list containing the selected ranges in the container
</code></p></li>
</ul>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
